Terraform Fundamentals
1.

 Terraform היא כלי בקוד פתוח המאפשר לנהל תשתיות (שרתים, רשתות, בסיסי נתונים) באמצעות קוד , במקום להקליק ידנית בפורטלים כמו AWS או Azure, כותבים קובץ הגדרות והכלי בונה הכל בשבילך.

במה היא שונה
- עבודה מול ספקים מרובים
- גישה דקלרטיבית: אתה מגדיר מה אתה רוצה לקבל, והיא מחליטה איך לבצע את זה
-ניהול מצב (State) : ה-State הוא קובץ (JSON) שמהווה את הזיכרון של Terraform הוא מבטיח שאם תריץ את הקוד שוב, Terraform לא תנסה ליצור הכל מאפס, אלא רק תשלים את מה שחסר בנוסף הוא מאפשר ל-Terraform לדעת מה המצב הקיים בשטח לעומת מה שביקשת בקוד, וכך להחליט אם ליצור, לעדכן או למחוק.

2.

דקלרטיבי (הצהרתי) - אתה לא כותב "תלחץ על הכפתור ותוסיף שרת", אתה כותב "אני רוצה שיהיו 3 שרתים". אם כבר יש 2, טרהפורם תבין לבד שהיא צריכה להוסיף רק אחד. אם יש 4, היא תמחוק אחד.

ניהול מצב (State Management): טרהפורם שומרת קובץ (בדרך כלל terraform.tfstate) שמהווה "מקור אמת". הקובץ הזה ממפה את המשאבים שמוגדרים בקוד שלך אל מול המשאבים שקיימים בפועל בענן.
זה עוזר לה להבין אילו שינויים נדרשים בכל פעם שמריצים אותה.

3.

ה-Provider (ספק) הוא ה"מתרגם" של טרהפורם. מכיוון שטרהפורם היא כלי גנרי, היא צריכה דרך לדבר עם שירותים ספציפיים.
- הפרוביידר (למשל של AWS או Google Cloud) מכיל את הלוגיקה שממירה את קוד הטרהפורם לקריאות API שהענן מבין.
*** בלי פרוביידר, טרהפורם לא תדע איך ליצור שום דבר.

4.

אתה כותב את המשאבים, טרהפורם מחשבת את הסדר
- תלות משתמעת (Implicit Dependency):  אם משאב א' משתמש במידע ממשאב ב', טרהפורם מבינה לבד שצריך ליצור קודם את ב'.
- תלות מפורשת (Explicit Dependency): משתמשים ב-depends_on (  הוראה שבה אתה אומר לטרהפורם: "אל תיגע במשאב הזה עד שמשאב אחר יסיים לעבוד") כשרוצים לקבוע סדר באופן ידני (כשאין קשר ישיר בקוד).
- ביצוע במקביל (Parallelism): כל מה שלא תלוי אחד בשני – נוצר במקביל כדי לחסוך זמן.

5.

Provider - זהו המרכיב שמסביר לטרהפורם עם איזה "ענן" או שירות היא הולכת לדבר (למשל AWS, Google Cloud, Azure).
מה הוא עושה: מגדיר את ההגדרות הבסיסיות כמו האזור (Region) או פרטי התחברות.

Resources - זה הלב של הקוד כאן מגדירים את התשתית הפיזית/וירטואלית שאתם רוצים ליצור.
מה הוא עושה: יוצר שרתים, מסדי נתונים, רשתות וכו'.

Variables - כמו בכל שפת תכנות, משתנים מאפשרים לנו להפוך את הקוד לדינמי וגמיש מבלי "לנעול" ערכים קבועים (Hardcoded).
מה הוא עושה: מאפשר לשנות הגדרות (כמו גודל השרת) מבלי לגעת בקוד המרכזי.

Outputs - לאחר שהתשתית נוצרה, לעיתים נרצה לקבל מידע חזרה.
מה הוא עושה: מדפיס למסך מידע כמו כתובת ה-IP של השרת שזה עתה נוצר.

Data Sources - מאפשרת לנו לשאוב מידע מתשתית שכבר קיימת בענן (ולא נוצרה על ידי הקוד הנוכחי שלנו).
מה הוא עושה: "לך תבדוק מה ה-ID של הרשת הקיימת בארגון שלי".

State Management & Backend Configuration

6.

terraform plan (התכנון) -
משווה בין הקוד שכתבת לבין המצב הקיים בענן ומציג לך דו"ח: מה יתווסף (+), מה ישתנה (~), ומה יימחק (-).

terraform apply (הביצוע) -
שולחת פקודות לענן (AWS, Azure וכו') כדי ליצור או לעדכן את המשאבים. בסיום, היא מעדכנת את קובץ ה-State (הזיכרון של טרהפורם).

terraform refresh (העדכון) -
פקודה זו הולכת לענן ובודקת אם נעשו שינויים ידניים (מחוץ לטרהפורם). היא מעדכנת את קובץ ה-State המקומי כדי שיהיה מתואם עם המציאות.

7.

Local Backend -
הקובץ נשמר על המחשב האישי שלך.
מתאים ללמידה או לפרויקטים קטנים של אדם אחד.
Remote Backend -
הקובץ נשמר בענן (כמו ב-S3, Azure Storage או Terraform Cloud).
מתאים לעבודה בצוות
*** בשורה התחתונה: Local זה לניסויים בבית, Remote זה לעבודה אמיתית בצוות.

8.

כשעובדים בצוות, הבעיה העיקרית היא ששני אנשים עלולים להריץ terraform apply בו-זמנית ולדרוס זה לזה את ה-"זיכרון" של המערכת (קובץ ה-State).
פתרון לבעיה

-אחסון מרוחק (Remote Backend) : במקום לשמור את קובץ ה-State על המחשב האישי של כל מהנדס (מה שיוצר חוסר סנכרון), שומרים אותו במקום מרכזי בענן (כמו S3 של AWS). כך כולם תמיד עובדים מול אותה גרסה.

-נעילת מצב (State Locking) : זהו המנגנון הקריטי למניעת התנגשויות. כאשר מהנדס אחד מריץ apply, טרהפורם "נועלת" את קובץ ה-State כך שם מהנדס אחר ינסה להריץ פקודה באותו זמן, הוא יקבל הודעת שגיאה שהקובץ נעול.

Terraform Modules & Reusability

9.










-- 